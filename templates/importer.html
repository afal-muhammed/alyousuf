{% extends 'base.html' %}
{% block content %}

<section class="hero-wrap d-flex align-items-center pd-top">
    <div class="container">
        <div class="row d-flex justify-content-center">
            <p>Paste excel data here:</p>
        </div>
         <textarea name="excel_data" style="width:400px;height:200px;"></textarea>
        <p>Table data will appear below</p>
        <button class="btn cursor export" onclick="javascript:generateTable()" value="Genereate Table">Generate Table
        </button>
    </div>
</section>
<section class="hero-wrap d-flex align-items-center pd-top">
    <div class="container">
        <div class="row d-flex justify-content-center">
            <div class="hero-title">
                <h1>Or</h1>
            </div>
        </div>
    </div>
</section>
<!--<p>Paste excel data here:</p>-->
<!--<div class="row">-->
<!--        <div class="col-md-6">-->
<!--             <textarea name="excel_data" style="width:250px;height:150px;"></textarea><br>-->
<!--             <input type="button" onclick="javascript:generateTable()" value="Genereate Table"/>-->
<!--            <br><br>-->
<!--    <p>Table data will appear below</p>-->
<!--    <hr>-->
<!--        </div>-->

<section class="hero-wrap d-flex align-items-center pd-top">
    <div class="container">
        <div class="row d-flex justify-content-center">
            <div class="col-md-4>">
                <form action="" method="POST" enctype="multipart/form-data" class="form-horizontal">
                    {% csrf_token %}
                    <div class="form-group">
                        <label for="name" class="col-md-3 col-sm-3 col-xs-12 control-label">Import Csv File: </label>
                        <div class="col-md-8">
                            <input type="file" name="csv_file" id="csv_file" required="True" class="form-control">
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="col-md-3 col-sm-3 col-xs-12 col-md-offset-3" style="margin-bottom:10px;">
                            <button class="btn btn-primary"><span class="glyphicon glyphicon-upload"
                                                                  style="margin-right:5px;"></span>Upload
                            </button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</section>

<!--<div class="col-md-4>">-->
<!--    <form action="" method="POST" enctype="multipart/form-data" class="form-horizontal">-->
<!--        {% csrf_token %}-->
<!--        <div class="form-group">-->
<!--            <label for="name" class="col-md-3 col-sm-3 col-xs-12 control-label">Import Csv File: </label>-->
<!--            <div class="col-md-8">-->
<!--                <input type="file" name="csv_file" id="csv_file" required="True" class="form-control">-->
<!--            </div>-->
<!--        </div>-->
<!--        <div class="form-group">-->
<!--            <div class="col-md-3 col-sm-3 col-xs-12 col-md-offset-3" style="margin-bottom:10px;">-->
<!--                <button class="btn btn-primary"><span class="glyphicon glyphicon-upload"-->
<!--                                                      style="margin-right:5px;"></span>Upload-->
<!--                </button>-->
<!--            </div>-->
<!--        </div>-->
<!--    </form>-->
<!--</div>-->
<div class="row">
    {% if messages %}
    <ul class="messages">
        {% for message in messages %}
        <li>{{ message }}</li>
        {% endfor %}
    </ul>
    {% endif %}
</div>

<form id="job" method="post">
    {% csrf_token %}
    <input type="hidden" name="jobs[]">
    <div id="excel_table"></div>
    <input id="submit" type="submit" value="Submit Table" class="hidden">
</form>


<script>
    function generateTable() {
    var data = $('textarea[name=excel_data]').val();
    console.log(data);
    var rows = data.split("\n");
    console.log(rows[0], "aaaaaaaaaaaaa");
    var table = $('<table />');
    for(var y in rows) {
        if(y==0)
        {
            var cells = rows[y].split("\t");
            var row = $('<tr />');
            for(var x in cells)
            {
            row.append('<th >'+cells[x]+'</th>');
            }
        }
        else
        {
            var cells = rows[y].split("\t");
            var row = $('<tr /><input type="hidden" name="table-rows[]" value="'+cells+'">');
            for(var x in cells)
            {
             row.append('<td>'+cells[x]+'</td>');
            }
        }
        table.append(row);
}

// Insert into DOM
$('#excel_table').html(table);
 var element = document.getElementById("submit");
  element.classList.remove("hidden");
}


</script>
{% endblock %}
